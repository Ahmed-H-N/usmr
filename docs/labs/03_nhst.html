<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Hypothesis testing</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-plus')) {
    f.classList.add('fa-minus')
    f.classList.remove('fa-plus')
} else {
    f.classList.add('fa-plus')
    f.classList.remove('fa-minus')
}
}
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="assets/style-labs.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><strong>USMR</strong></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="00_intro.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data &amp; Distributions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_categorical.html">Categorical distributions</a>
    </li>
    <li>
      <a href="02_numerical.html">Numeric distributions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Formalising things
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="05_nhst.html">Hypothesis testing</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Hypothesis testing</h1>

</div>


<div class="red">
<p><strong>Preliminaries</strong></p>
<ol style="list-style-type: decimal">
<li>Open Rstudio, make sure you have the USMR project open, and create a new RMarkdown document (giving it a title for this week).</li>
</ol>
</div>
<div id="reading-standard-error" class="section level1">
<h1>Reading: Standard error</h1>
<p>Recall what we have seen thus far:</p>
<ul>
<li><p>We can generate a sample of size <span class="math inline">\(n\)</span>, drawn from a population which has a mean of <span class="math inline">\(\mu\)</span> and a standard deviation of <span class="math inline">\(\sigma\)</span>:</p>
<pre class="r"><code># draw random sample of n = 10 from 
# a population with mean 178 and sd 10
rnorm(n = 20, mean = 178, sd = 10)</code></pre></li>
<li><p>And we can calculate the mean of a random sample:</p>
<pre class="r"><code>mean(rnorm(n = 20, mean = 178, sd = 10))</code></pre>
<pre><code>## [1] 182.4367</code></pre></li>
<li><p>We can repeat this process many times (using <code>replicate()</code>), so that we have many sample means:</p>
<pre class="r"><code>manysamplemeans &lt;- replicate(1000, mean(rnorm(n = 20, mean = 178, sd = 10)))
# we now have 1000 sample means
length(manysamplemeans)</code></pre>
<pre><code>## [1] 1000</code></pre></li>
</ul>
<p><strong>Question: Why are we doing this?</strong></p>
<p>What we’re doing here is showing the process of taking many samples of the same size from a population, and calculating a statistic on each sample.<br />
The distribution of these sample statistics shows how they will vary from sample to sample due to chance.</p>
<p>In the above example, for samples of <span class="math inline">\(n=20\)</span> drawn from a population with mean <span class="math inline">\(\mu=178\)</span>, and standard deviation <span class="math inline">\(\sigma=10\)</span>, we’re quite likely to get sample means between 174 and 182, and we’re less likely to see sample means <span class="math inline">\(&lt;174\)</span> and <span class="math inline">\(&gt;182\)</span>.</p>
<pre class="r"><code>hist(manysamplemeans)</code></pre>
<p><img src="03_nhst_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="yellow">
<ul>
<li>The theoretical distribution of how sample statistics will vary on repeated sampling is known as the <strong>sampling distribution</strong>.<br />
</li>
<li>The standard deviation of the sampling distribution is known as the <strong>standard error</strong>.<br />
</li>
<li>Note that the bigger our sample size, the smaller our standard error - i.e., the more precise our sample means are going to be as estimates of the population mean:
<img src="03_nhst_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;" /></li>
</ul>
</div>
<div id="standard-error-in-practice" class="section level2">
<h2>Standard Error in practice</h2>
<p>In practice, we cannot actually draw lots and lots of samples in order to construct a sampling distribution, and we do not know the population parameters which are required to generate samples like we did above.</p>
<p>Instead, we start with just one observed sample, e.g.:</p>
<pre class="r"><code>observed_sample &lt;- c(176.86, 169.45, 177.93, 175.89, 169.05, 162.56, 189.29, 196.15, 159.45, 165.69, 186.88, 176.9, 188.52, 164.05, 175.62, 180.89, 193.63, 161.59, 182.74, 184.23)</code></pre>
<p>What we <em>can</em> do is either:</p>
<ul>
<li><p><strong>A:</strong> Simulate lots of sampling. We can actually use <em>resampling with replacement</em> from our original sample as a means of imitating repeated sampling. This is known as <strong>Bootstrapping</strong>.</p>
<pre class="r"><code># bootstrap resample means
bootstrap_means &lt;- replicate(1000, mean(sample(observed_sample, replace = TRUE)))
# SE = sd of bootstrap resample means 
sd(bootstrap_means)</code></pre>
<pre><code>## [1] 2.452104</code></pre></li>
<li><p>or <strong>B:</strong> Estimate the standard error using a formula:<br />
<span class="math display">\[
SE = \frac{\sigma}{\sqrt{n}}  \\
\quad \\
\begin{align}
&amp; \text{Where} \\
&amp; \sigma = \text{standard deviation} \\
&amp; n = \text{sample size} \\
\end{align}
\]</span>
Note that <span class="math inline">\(\sigma\)</span> is the standard deviation of the population, which is unknown to us. However, we can use the standard deviation of our sample (<span class="math inline">\(\hat \sigma\)</span> or <span class="math inline">\(s\)</span>) as our estimate of this:</p>
<pre class="r"><code># SE = standard deviation / square root of n
sd(observed_sample)/sqrt(length(observed_sample))</code></pre>
<pre><code>## [1] 2.459404</code></pre></li>
</ul>
</div>
</div>
<div id="reading-hypothesis-testing" class="section level1">
<h1>Reading: Hypothesis testing</h1>
<p>The sampling distribution is at the basis of null hypothesis significance testing.</p>
<p>Recall from the previous lab that we had a dataset on 131 participants who took part in a Stroop Task experiment. Each participant completed a color-naming task in two conditions: Matching and Mismatching. The differences in participants’ times for each condition are taken as indicating the effect of the color-word inteference (We have been calling this the “stroop effect”).</p>
<p>In our observed sample, the stroop effect had a mean <span class="math inline">\(\bar x =\)</span> 7.9 and a standard deviation <span class="math inline">\(s=\)</span> 5.02.</p>
<p>We can theorise about what the sampling distribution of means from samples of size <span class="math inline">\(n=131\)</span> would be like, assuming there to be no stroop effect (i.e., the mean in the population is zero).</p>
<ul>
<li><p>We can estimate the standard error by generating many samples of size <span class="math inline">\(n=131\)</span>:</p>
<pre class="r"><code># bootstrap resample means:
many_stroop_means &lt;- replicate(1000, mean(sample(stroopdata$stroop_effect, replace = TRUE)))
# standard deviation of 1000 resample means
sd(many_stroop_means)</code></pre>
<pre><code>## [1] 0.4474773</code></pre></li>
<li><p>or we can estimate it by using the sample formula: <span class="math inline">\(\frac{\hat \sigma}{\sqrt{n}} = \frac{5.02}{\sqrt{131}} = 0.439\)</span>.</p></li>
</ul>
<p><br>
Either way, what we get is an idea of the distribution of what we would expect from means from samples of 131, under the hypothesis that there is no “stroop effect” - it will have a mean of 0 and a standard deviation of approximately 0.44.<br />
Against this, we can then compare our observed mean:</p>
<div class="figure" style="text-align: center"><span id="fig:hyp"></span>
<img src="03_nhst_files/figure-html/hyp-1.png" alt="Sampling distribution assuming population mean = 0, and observed sample mean" width="576" />
<p class="caption">
Figure 1: Sampling distribution assuming population mean = 0, and observed sample mean
</p>
</div>
<p>What we implicitly have here are two competing hypotheses: the null hypothesis (<span class="math inline">\(H_0\)</span>), and an alternative hypothesis (<span class="math inline">\(H_1\)</span>):</p>
<ul>
<li><span class="math inline">\(H_0: \mu = 0\)</span> The mean “stroop effect” in the population is equal to 0.<br />
</li>
<li><span class="math inline">\(H_1: \mu \neq 0\)</span> The mean “stroop effect” in the population is not equal to 0.</li>
</ul>
<p>We can do is perform a statistical test against the null hypothesis.</p>
<div id="a-simple-t-test" class="section level2">
<h2>A simple t-test</h2>
<p>For determine whether a sample mean <span class="math inline">\(\bar x\)</span> is likely to have been generated by a process with a specific mean <span class="math inline">\(\mu_0\)</span>, we can calculate a <span class="math inline">\(t\)</span>-statistic:<br />
<span class="math display">\[
t = \frac{\bar x - \mu_0}{\frac{s}{\sqrt{n}}}
\]</span>
Think about what each part of the formula represents. The top part <span class="math inline">\(\bar{x}-\mu_0\)</span> is the distance from the observed mean to the hypothesised mean:</p>
<pre class="r"><code>mean(stroopdata$stroop_effect) - 0</code></pre>
<pre><code>## [1] 7.902977</code></pre>
<p>And the bottom part is the standard error - the standard deviation of the sampling distribution:</p>
<pre class="r"><code># SE = sd / sqrt(n)
sd(stroopdata$stroop_effect)/sqrt(length(stroopdata$stroop_effect))</code></pre>
<pre><code>## [1] 0.4382302</code></pre>
<p><img src="03_nhst_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Let’s calculate it now:</p>
<pre class="r"><code>t_obs = (mean(stroopdata$stroop_effect) - 0 ) / (sd(stroopdata$stroop_effect)/sqrt(131))
t_obs</code></pre>
<pre><code>## [1] 18.03385</code></pre>
<p>We can now ask, assuming the null hypothesis <span class="math inline">\(H_0\)</span> to be true, what is the probability that we observe a t-statistic at least as extreme as the one we observed?</p>
<div class="yellow">
<p><strong>Probability in NHST (null hypothesis significance testing)</strong></p>
<p>Probabilities in NHST are defined as the relative frequency of an event <em>over many trials</em> (as “many” <span class="math inline">\(\to \infty\)</span>).
This requires assuming some features of the data generating process which guides what the “many trials” would look like (e.g., that there is no effect).</p>
<p>A p-value is the probability of observing results as or more extreme than the data, <em>if the data were really generated by a hypothesised chance process</em>.</p>
</div>
<p><img src="03_nhst_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code>t_obs = (mean(stroopdata$stroop_effect) - 0 ) / (sd(stroopdata$stroop_effect)/sqrt(131))</code></pre>
<pre class="r"><code>7.902977/(sd(stroopdata$stroop_effect)/sqrt(131))</code></pre>
<pre><code>## [1] 18.03385</code></pre>
<pre class="r"><code>t.test(x = stroopdata$stroop_effect, mu=0)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  stroopdata$stroop_effect
## t = 18.034, df = 130, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  7.035991 8.769963
## sample estimates:
## mean of x 
##  7.902977</code></pre>
</div>
</div>
<div id="exercises" class="section level1">
<h1>Exercises:</h1>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
